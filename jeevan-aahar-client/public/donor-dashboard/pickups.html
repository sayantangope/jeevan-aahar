<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduled Pickups - JeevanAhaar</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <button class="pagination-button px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">
        1
    </button>
    <button class="pagination-button px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300 active">
        2
    </button>
    
    <style>
    
        
        .sidebar-active {
            background-color: #e2f8e9;
            color: #2c7a51;
            border-left: 4px solid #2c7a51;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .jeevan-green {
            color: #2c7a51;
        }
        .jeevan-bg-green {
            background-color: #2c7a51;
        }
        .jeevan-light-bg {
            background-color: #f8f9fa;
        }
        .view-button-active {
            background-color: #e2f8e9;
            color: #2c7a51;
            font-size: medium;
        }
        .pagination-button.active {
            font-weight: 600; /* equivalent to font-semibold */
            background-color: #D1D5DB; /* equivalent to bg-gray-300 */
        }
        
    </style>
</head>
<body class="bg-gray-100">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-md">
            <div class="p-4 border-b">
                <a href="/" class="flex items-center">
                    <span class="text-red-500 text-2xl font-bold">Jeevan</span>
                    <span class="text-green-500 text-2xl font-bold">Ahaar</span>
                </a>
            </div>
            <div class="py-4">
                <a href="/dashboard" class="flex items-center px-6 py-3 hover:bg-gray-100">
                    <i class="fas fa-th-large mr-3 jeevan-green"></i>
                    <span>Dashboard</span>
                </a>
                <a href="/my-donations" class="flex items-center px-6 py-3 hover:bg-gray-100">
                    <i class="fas fa-hand-holding-heart mr-3 jeevan-green"></i>
                    <span>My Donations</span>
                </a>
                <a href="/scheduled-pickups" class="flex items-center px-6 py-3 sidebar-active">
                    <i class="fas fa-calendar-check mr-3 jeevan-green"></i>
                    <span>Scheduled Pickups</span>
                </a>
                <a href="/settings" class="flex items-center px-6 py-3 hover:bg-gray-100">
                    <i class="fas fa-cog mr-3 jeevan-green"></i>
                    <span>Settings</span>
                </a>
            </div>
            <div class="absolute bottom-0 w-64 border-t p-4 flex items-center">
                <div class="w-10 h-10 rounded-full bg-green-200 flex items-center justify-center text-green-800">
                    SR
                </div>
                <div class="ml-3">
                    <p class="font-medium">Sarah Reynolds</p>
                    <p class="text-xs text-gray-500">Premium Donor</p>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h1 class="text-2xl font-bold">Scheduled Pickups</h1>
                        <p class="text-gray-600" id="current-date">Wednesday, April 23, 2025</p>
                    </div>
                    <!-- "Schedule New Pickup" button removed as requested -->
                </div>

                <!-- Pickup Calendar View -->
                <div class="bg-white p-6 rounded-lg shadow-md mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold">Upcoming Pickups</h2>
                        <div class="flex space-x-2">
                            <button id="prev-month" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span class="px-3 py-1" id="current-month">April 2025</span>
                            <button id="next-month" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="flex space-x-2">
                            <button id="view-month" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">Month</button>
                            <button id="view-week" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">Week</button>
                            <button id="view-list" class="px-3 py-1 bg-green-100 text-green-700 rounded-md font-medium view-button-active">List</button>
                        </div>
                    </div>
                    
                    <!-- Month View (Hidden by default) -->
                    <div id="month-view" class="hidden mb-6">
                        <div class="grid grid-cols-7 gap-1">
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Sun</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Mon</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Tue</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Wed</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Thu</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Fri</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Sat</div>
                        </div>
                        <div id="calendar-days" class="grid grid-cols-7 gap-1">
                            <!-- Calendar days will be inserted here by JavaScript -->
                        </div>
                    </div>

                    <!-- Week View (Hidden by default) -->
                    <div id="week-view" class="hidden mb-6">
                        <div class="grid grid-cols-7 gap-1">
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Sun</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Mon</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Tue</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Wed</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Thu</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Fri</div>
                            <div class="text-center py-2 text-sm font-medium text-gray-500">Sat</div>
                        </div>
                        <div id="week-days" class="grid grid-cols-7 gap-1">
                            <!-- Week days will be inserted here by JavaScript -->
                        </div>
                    </div>

                    <!-- Pagination for List View -->
                    <div id="pagination" class="flex justify-center space-x-2 mb-4">
                        <button id="prev-page" class="pagination-button">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <!-- Page buttons will be dynamically added here -->
                        <button id="next-page" class="pagination-button">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>

                    <!-- Pickup List -->
                    <div id="list-view" class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pickup ID</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date & Time</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Food Type</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Driver</th>
                                    <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="pickupsList" class="divide-y divide-gray-200">
                                <!-- Dynamic content will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Enhanced sample data with more pickups across different months
const allPickups = [
// February pickups
{
    id: "PK-20250215-001",
    date: "2025-02-15T09:15:00",
    foodType: "Packaged Meals",
    quantity: 15,
    status: "Completed",
    driver: "Michael Chen",
},
{
    id: "PK-20250220-001",
    date: "2025-02-20T14:30:00",
    foodType: "Fresh Vegetables",
    quantity: 30,
    status: "Completed",
    driver: "Sophia Rodriguez",
},
// March pickups
{
    id: "PK-20250305-001",
    date: "2025-03-05T11:00:00",
    foodType: "Baked Goods",
    quantity: 50,
    status: "Completed",
    driver: "David Kim",
},
{
    id: "PK-20250312-001",
    date: "2025-03-12T16:15:00",
    foodType: "Cooked Meals",
    quantity: 20,
    status: "Completed",
    driver: "Michael Chen",
},
{
    id: "PK-20250325-001",
    date: "2025-03-25T10:45:00",
    foodType: "Rice and Pulses",
    quantity: 35,
    status: "Completed",
    driver: "Sophia Rodriguez",
},
// April pickups
{
    id: "PK-20250405-001",
    date: "2025-04-05T13:30:00",
    foodType: "Cooked Meals",
    quantity: 25,
    status: "Completed",
    driver: "David Kim",
},
{
    id: "PK-20250412-001",
    date: "2025-04-12T09:00:00",
    foodType: "Fruits",
    quantity: 40,
    status: "Completed",
    driver: "Michael Chen",
},
{
    id: "PK-20250418-001",
    date: "2025-04-18T15:45:00",
    foodType: "Dry Rations",
    quantity: 30,
    status: "Completed",
    driver: "Sophia Rodriguez",
},
{
    id: "PK-20250423-001",
    date: "2025-04-24T10:30:00",
    foodType: "Cooked Meals",
    quantity: 25,
    status: "Confirmed",
    driver: "Michael Chen",
},
{
    id: "PK-20250423-002",
    date: "2025-04-26T13:00:00",
    foodType: "Fruits",
    quantity: 40,
    status: "Pending",
    driver: "Awaiting Assignment",
},
{
    id: "PK-20250423-003",
    date: "2025-04-29T16:45:00",
    foodType: "Dry Rations",
    quantity: 15,
    status: "Scheduled",
    driver: "Sophia Rodriguez",
},
// May pickups
{
    id: "PK-20250505-001",
    date: "2025-05-05T11:30:00",
    foodType: "Cooked Meals",
    quantity: 35,
    status: "Scheduled",
    driver: "Not Assigned",
},
{
    id: "PK-20250512-001",
    date: "2025-05-12T14:00:00",
    foodType: "Fresh Vegetables",
    quantity: 20,
    status: "Scheduled",
    driver: "Not Assigned",
}
];

// Application state
const state = {
currentDate: new Date('2025-04-23'),
currentView: 'list', // 'list', 'month', or 'week'
currentPage: 1,
itemsPerPage: 5,
selectedMonth: new Date('2025-04-01'),
selectedWeek: new Date('2025-04-21') // Start of week containing April 23
};

// Function to format date for display
function formatDate(dateString) {
const date = new Date(dateString);
const options = { 
    weekday: 'short', 
    year: 'numeric', 
    month: 'short', 
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
};
return date.toLocaleDateString('en-US', options);
}

// Function to format month for display
function formatMonth(date) {
return date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
}

// Function to get pickup data for the current month
function getPickupsForMonth(date) {
const year = date.getFullYear();
const month = date.getMonth();
return allPickups.filter(pickup => {
    const pickupDate = new Date(pickup.date);
    return pickupDate.getFullYear() === year && pickupDate.getMonth() === month;
});
}

// Function to get pickup data for the current week
function getPickupsForWeek(date) {
// Calculate start of the week (Sunday)
const startOfWeek = new Date(date);
startOfWeek.setDate(date.getDate() - date.getDay());

// Calculate end of the week (Saturday)
const endOfWeek = new Date(startOfWeek);
endOfWeek.setDate(startOfWeek.getDate() + 6);
endOfWeek.setHours(23, 59, 59, 999);

return allPickups.filter(pickup => {
    const pickupDate = new Date(pickup.date);
    return pickupDate >= startOfWeek && pickupDate <= endOfWeek;
});
}

// Function to render the pickups list with pagination
function renderPickupsList(pickups) {
const pickupsList = document.getElementById('pickupsList');
pickupsList.innerHTML = '';

// Calculate total pages
const totalPages = Math.ceil(pickups.length / state.itemsPerPage);

// Get current page items
const startIndex = (state.currentPage - 1) * state.itemsPerPage;
const endIndex = Math.min(startIndex + state.itemsPerPage, pickups.length);
const currentPageItems = pickups.slice(startIndex, endIndex);

if (currentPageItems.length === 0) {
    pickupsList.innerHTML = `
        <tr>
            <td colspan="7" class="py-4 px-4 text-center text-gray-500">
                No scheduled pickups found.
            </td>
        </tr>
    `;
    return;
}

currentPageItems.forEach(pickup => {
    const statusClass = getStatusClass(pickup.status);
    const row = document.createElement('tr');
    row.innerHTML = `
        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${pickup.id}</td>
        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${formatDate(pickup.date)}</td>
        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${pickup.foodType}</td>
        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${pickup.quantity} servings</td>
        <td class="px-4 py-4 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                ${pickup.status}
            </span>
        </td>
        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${pickup.driver}</td>
        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
            <button class="text-gray-600 hover:text-gray-900 mr-3 view-btn" data-id="${pickup.id}">
                <i class="fas fa-eye"></i>
            </button>
            <button class="text-red-600 hover:text-red-900 cancel-btn" data-id="${pickup.id}">
                <i class="fas fa-times-circle"></i>
            </button>
        </td>
    `;
    pickupsList.appendChild(row);
});

// Update pagination buttons
updatePagination(totalPages);

// Add event listeners to view and cancel buttons
document.querySelectorAll('.view-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
        const pickupId = e.currentTarget.getAttribute('data-id');
        viewPickupDetails(pickupId);
    });
});

document.querySelectorAll('.cancel-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
        const pickupId = e.currentTarget.getAttribute('data-id');
        cancelPickup(pickupId);
    });
});
}

// Function to update pagination buttons
function updatePagination(totalPages) {
const paginationContainer = document.getElementById('pagination');
const prevPageButton = document.getElementById('prev-page');
const nextPageButton = document.getElementById('next-page');

// Remove all page number buttons
Array.from(paginationContainer.querySelectorAll('button:not(#prev-page):not(#next-page)')).forEach(btn => {
    btn.remove();
});

// Enable/disable previous/next buttons
prevPageButton.disabled = state.currentPage <= 1;
nextPageButton.disabled = state.currentPage >= totalPages;

// Add page number buttons
for (let i = 1; i <= totalPages; i++) {
    const pageButton = document.createElement('button');
    pageButton.className = `pagination-button ${state.currentPage === i ? 'active' : ''}`;
    pageButton.textContent = i;
    pageButton.addEventListener('click', () => {
        state.currentPage = i;
        updateView();
    });
    // Insert before the next page button
    paginationContainer.insertBefore(pageButton, nextPageButton);
}
}

// Function to render the month view
function renderMonthView() {
const calendarDays = document.getElementById('calendar-days');
calendarDays.innerHTML = '';

const year = state.selectedMonth.getFullYear();
const month = state.selectedMonth.getMonth();

// First day of the month
const firstDay = new Date(year, month, 1);
// Last day of the month
const lastDay = new Date(year, month + 1, 0);

// Get the day of the week for the first day (0 = Sunday, 6 = Saturday)
const firstDayOfWeek = firstDay.getDay();

// Get the pickups for this month
const monthPickups = getPickupsForMonth(state.selectedMonth);

// Create array of pickup dates for easy checking
const pickupDates = monthPickups.map(pickup => {
    const date = new Date(pickup.date);
    return date.getDate();
});

// Add empty cells for days before the first day of the month
for (let i = 0; i < firstDayOfWeek; i++) {
    const emptyCell = document.createElement('div');
    emptyCell.className = 'p-2 bg-gray-100 h-24';
    calendarDays.appendChild(emptyCell);
}

// Add cells for each day of the month
for (let day = 1; day <= lastDay.getDate(); day++) {
    const cell = document.createElement('div');
    cell.className = 'p-2 bg-white border h-24 overflow-auto';
    
    // Add day number
    const dayNumber = document.createElement('div');
    dayNumber.className = 'font-medium text-right';
    dayNumber.textContent = day;
    cell.appendChild(dayNumber);
    
    // Check if this day has any pickups
    const hasPickups = pickupDates.includes(day);
    if (hasPickups) {
        // Get pickups for this day
        const dayPickups = monthPickups.filter(pickup => {
            const date = new Date(pickup.date);
            return date.getDate() === day;
        });
        
        // Add pickup indicators
        dayPickups.forEach(pickup => {
            const pickupElement = document.createElement('div');
            pickupElement.className = `text-xs p-1 mt-1 rounded ${getStatusClass(pickup.status)}`;
            pickupElement.textContent = `${new Date(pickup.date).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} - ${pickup.foodType}`;
            pickupElement.setAttribute('data-id', pickup.id);
            pickupElement.addEventListener('click', () => viewPickupDetails(pickup.id));
            cell.appendChild(pickupElement);
        });
    }
    
    calendarDays.appendChild(cell);
}
}

// Function to render the week view
function renderWeekView() {
const weekDays = document.getElementById('week-days');
weekDays.innerHTML = '';

// Calculate start of the week (Sunday)
const startOfWeek = new Date(state.selectedWeek);
startOfWeek.setDate(state.selectedWeek.getDate() - state.selectedWeek.getDay());

// Get pickups for this week
const weekPickups = getPickupsForWeek(state.selectedWeek);

// Create cells for each day of the week
for (let i = 0; i < 7; i++) {
    const currentDay = new Date(startOfWeek);
    currentDay.setDate(startOfWeek.getDate() + i);
    
    const cell = document.createElement('div');
    cell.className = 'p-2 bg-white border h-40 overflow-auto';
    
    // Add date
    const dateElement = document.createElement('div');
    dateElement.className = 'font-medium text-center mb-2';
    dateElement.textContent = currentDay.getDate();
    cell.appendChild(dateElement);
    
    // Get pickups for this day
    const dayPickups = weekPickups.filter(pickup => {
        const pickupDate = new Date(pickup.date);
        return pickupDate.getDate() === currentDay.getDate() &&
               pickupDate.getMonth() === currentDay.getMonth() &&
               pickupDate.getFullYear() === currentDay.getFullYear();
    });
    
    // Add pickup indicators
    dayPickups.forEach(pickup => {
        const pickupElement = document.createElement('div');
        pickupElement.className = `text-xs p-1 mb-1 rounded ${getStatusClass(pickup.status)}`;
        pickupElement.textContent = `${new Date(pickup.date).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} - ${pickup.foodType}`;
        pickupElement.setAttribute('data-id', pickup.id);
        pickupElement.addEventListener('click', () => viewPickupDetails(pickup.id));
        cell.appendChild(pickupElement);
    });
    
    weekDays.appendChild(cell);
}
}

// Get CSS class for status badge
function getStatusClass(status) {
switch(status) {
    case 'Confirmed':
        return 'bg-green-100 text-green-800';
    case 'Pending':
        return 'bg-yellow-100 text-yellow-800';
    case 'Scheduled':
        return 'bg-blue-100 text-blue-800';
    case 'Completed':
        return 'bg-gray-100 text-gray-800';
    case 'Cancelled':
        return 'bg-red-100 text-red-800';
    default:
        return 'bg-gray-100 text-gray-800';
}
}

// Function to view pickup details
function viewPickupDetails(pickupId) {
// Find the pickup 
const pickup = allPickups.find(p => p.id === pickupId);
if (!pickup) return;

// Display pickup details (in a real app, this might show a modal)
alert(`Pickup Details for ${pickupId}:\n\nFood Type: ${pickup.foodType}\nQuantity: ${pickup.quantity} servings\nDate: ${formatDate(pickup.date)}\nStatus: ${pickup.status}\nDriver: ${pickup.driver}`);
}

// Function to handle cancelling a pickup
function cancelPickup(pickupId) {
// In a real app, this would update the pickup status in MongoDB
if (confirm(`Are you sure you want to cancel pickup ${pickupId}?`)) {
    // Find and update the pickup
    const pickup = allPickups.find(p => p.id === pickupId);
    if (pickup) {
        pickup.status = 'Cancelled';
        updateView();
        alert(`Pickup ${pickupId} has been cancelled. In a real app, this would update MongoDB.`);
    }
}
}

// Function to update the view based on current application state
function updateView() {
// Update current date display
document.getElementById('current-date').textContent = state.currentDate.toLocaleDateString('en-US', { 
    weekday: 'long', 
    month: 'long', 
    day: 'numeric', 
    year: 'numeric' 
});

// Update month display
document.getElementById('current-month').textContent = formatMonth(state.selectedMonth);

// Update view buttons
document.getElementById('view-month').className = 'px-3 py-1 rounded-md hover:bg-gray-300 ' + 
    (state.currentView === 'month' ? 'bg-green-100 text-green-700 font-medium view-button-active' : 'bg-gray-200');
document.getElementById('view-week').className = 'px-3 py-1 rounded-md hover:bg-gray-300 ' + 
    (state.currentView === 'week' ? 'bg-green-100 text-green-700 font-medium view-button-active' : 'bg-gray-200');
document.getElementById('view-list').className = 'px-3 py-1 rounded-md hover:bg-gray-300 ' + 
    (state.currentView === 'list' ? 'bg-green-100 text-green-700 font-medium view-button-active' : 'bg-gray-200');

// Show/hide view containers
document.getElementById('month-view').style.display = state.currentView === 'month' ? 'block' : 'none';
document.getElementById('week-view').style.display = state.currentView === 'week' ? 'block' : 'none';
document.getElementById('list-view').style.display = state.currentView === 'list' ? 'block' : 'none';
document.getElementById('pagination').style.display = state.currentView === 'list' ? 'flex' : 'none';

// Render appropriate view
switch (state.currentView) {
    case 'month':
        renderMonthView();
        break;
    case 'week':
        renderWeekView();
        break;
    case 'list':
        renderPickupsList(allPickups);
        break;
}
}

// Event Listeners
document.addEventListener('DOMContentLoaded', () => {
// View toggles
document.getElementById('view-month').addEventListener('click', () => {
    state.currentView = 'month';
    updateView();
});

document.getElementById('view-week').addEventListener('click', () => {
    state.currentView = 'week';
    updateView();
});

document.getElementById('view-list').addEventListener('click', () => {
    state.currentView = 'list';
    updateView();
});

// Month navigation
document.getElementById('prev-month').addEventListener('click', () => {
    state.selectedMonth.setMonth(state.selectedMonth.getMonth() - 1);
    updateView();
});

document.getElementById('next-month').addEventListener('click', () => {
    state.selectedMonth.setMonth(state.selectedMonth.getMonth() + 1);
    updateView();
});

// Pagination navigation
document.getElementById('prev-page').addEventListener('click', () => {
    if (state.currentPage > 1) {
        state.currentPage--;
        updateView();
    }
});

document.getElementById('next-page').addEventListener('click', () => {
    const totalPages = Math.ceil(allPickups.length / state.itemsPerPage);
    if (state.currentPage < totalPages) {
        state.currentPage++;
        updateView();
    }
});

// Initial render
updateView();
});
    </script>
</body>
</html>